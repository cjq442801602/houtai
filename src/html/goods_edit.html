<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>商品添加</title>
	<link rel="stylesheet" href="../assets/layui/css/layui.css">
	<link rel="stylesheet" href="../css/table_center.css">
	<script src="../js/common.js"></script>
</head>

<body class="layui-layout-body">
	<div class="layui-layout layui-layout-admin">
		<div class="layui-header">
			<div class="layui-logo">后台管理系统</div>
			<!-- 头部区域（可配合layui已有的水平导航） -->
			<ul class="layui-nav layui-layout-left">
				<li class="layui-nav-item"><a href="center.html">首页</a></li>
				<li class="layui-nav-item"><a href="javascript:;"></a></li>
				<li class="layui-nav-item"><a href="javascript:;">商品管理</a></li>
				<li class="layui-nav-item"><a href="javascript:;"></a></li>
				<li class="layui-nav-item"><a href="javascript:;">商品添加</a></li>
			</ul>

			<ul class="layui-nav layui-layout-right">
				<li class="layui-nav-item">
					<a href="javascript:;">
						<img src="../assets/img/mao.png" class="layui-nav-img">
						<span id="adminName">God</span>
					</a>
				</li>
				<li class="layui-nav-item"><a href="javascript:;" id="logout">退出登录</a></li>
			</ul>
		</div>


		<div class="layui-side layui-bg-black">
			<div class="layui-side-scroll">
				<!-- 左侧导航区域（可配合layui已有的垂直导航） -->
				<ul class="layui-nav layui-nav-tree" lay-filter="test">
					<li class="layui-nav-item layui-nav-itemed">
						<a class="" href="center.html">首页</a>
					</li>

					<li class="layui-nav-item layui-nav-itemed">
						<a class="" href="javascript:;">商品管理</a>
						<dl class="layui-nav-child">
							<dd><a href="goodslist.html">商品列表</a></dd>
							<dd><a href="category.html">商品分类</a></dd>
							<dd><a href="javascript:;">商品添加</a></dd>
						</dl>
					</li>

					<li class="layui-nav-item">
						<a href="javascript:;">用户管理</a>
						<dl class="layui-nav-child">
							<dd><a href="user.html">用户列表</a></dd>
							<dd><a href="user_add.html">用户添加</a></dd>
						</dl>
					</li>
					<li class="layui-nav-item">
						<a href="javascript:;">订单管理</a>
						<dl class="layui-nav-child">
							<dd><a href="orders.html">订单列表</a></dd>
						</dl>
					</li>

				</ul>
			</div>
		</div>

		<div class="layui-body">

			<div class="table_center">
				<!--========================== 商品添加 添加内容区域 ==============================---->
				<div class="layui-form" lay-filter="formBox">
					<div class="layui-form-item">
						<label class="layui-form-label">商品名称</label>
						<div class="layui-input-block">
							<input type="text"  name="name" required lay-verify="required" placeholder="20字以内" autocomplete="off" maxlength="20"
							 class="layui-input" style="width: 311px;">
						</div>
					</div>
					<!--======商品价格========---->
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">商品价格</label>
							<div class="layui-input-inline">
								<input type="text" name="price" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>
					<!--======商品分类========---->
					<div class="layui-form-item">
						<label class="layui-form-label">商品分类</label>
						<div class="layui-input-block" style="width: 190px;">
							<select name="category" lay-verify="required">
								<option value="时尚">时尚</option>
								<option value="穿搭">穿搭</option>
								<option value="家具">家具</option>
								<option value="饮食">饮食</option>
								<option value="家电">家电</option>
							</select>
						</div>
					</div>
					<!--======商品图片========---->
					<div class="layui-form-item">
						<label class="layui-form-label">商品图片</label>
						<div class="layui-input-block">
							<!-- <input type="text" lay-verify="pass" name="tupian" required lay-verify="required" 
							 autocomplete="off" class="layui-input" style="width: 190px;"> -->
						</div>
					</div>
					<!--======库存========---->
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">库存</label>
							<div class="layui-input-inline">
								<input type="tel" name="stock" lay-verify="past" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>
					<!--======复选框========---->
					<div class="layui-form-item">
						<label class="layui-form-label">销量</label>
						<div class="layui-input-inline">
							<input type="tel" name="sales" lay-verify="past" autocomplete="off" class="layui-input">
						</div>
					</div>
					<!--======上架========---->
					<div class="layui-form-item">
						<label class="layui-form-label">上架</label>
						<div class="layui-input-block">
							<input type="checkbox" checked="" name="state" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
						</div>
					</div>
					<!--======商品描述========---->
					<div class="layui-form-item layui-form-text">
						<label class="layui-form-label">描述</label>
						<div class="layui-input-block">
							<textarea name="description" placeholder="商品描述内容" class="layui-textarea"style="width: 400px; height: 100px;"></textarea>
						</div>
					</div>
					<div class="layui-form-item">
						<div class="layui-input-block">
							<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
							<button type="reset" class="layui-btn layui-btn-primary">重置</button>
						</div>
					</div>
				</div>

			</div>
		</div>


	</div>
	<script src="../assets/layui/layui.js"></script>
	<script>
        //JavaScript代码区域，左边手风琴控制
        layui.use('element', function () {
            var element = layui.element;
			let quit =  document.querySelector('#logout');
            logging();
            quit.onclick = logout;
        });
    </script>
	<script>
		//接收用户id，并对数据库进行查询并返回数据
        function getData(){
            return new Promise((resolve,reject)=>{
                let goodsId = Cookie.get('goodsId');
                let data = {_id:goodsId};
                data = objToStr(data);
                ajax('GET','/goodslist',data,(res)=>{
                    let result = JSON.parse(res);
                    resolve(result.data[0]);
                })
            });
        }
	</script>
	<script>
		layui.use(['form', 'laydate'],async function () {
            var form = layui.form
                , layer = layui.layer;

			//获取数据库返回数据进行渲染
			let goodsData = await getData();
            form.val("formBox", {
                "name": goodsData.name
                ,"price": goodsData.price
                ,"sales": goodsData.sales
                ,"category": goodsData.category
                ,"stock": goodsData.stock
                ,"description": goodsData.description
                ,"state": goodsData.state
            })
			
			//监听提交
			form.on('submit(formDemo)', function (data) {
				layer.msg(JSON.stringify(data.field));
				data.field._id = goodsData._id;
				data.field.state = goodsData.state;
                let _data = objToStr(data.field);
                console.log(_data);
                ajax('POST','/goodslist',_data);
                location.href = './goodslist.html';
			});

			form.on('switch(switchTest)', function(data){
				if(data.elem.checked) {
					goodsData.state = "1";
				} else {
					goodsData.state = "0";
				}
			});  
		});
	</script>
</body>

</html>
<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>商品添加</title>
	<link rel="stylesheet" href="../assets/layui/css/layui.css">
	<link rel="stylesheet" href="../css/table_center.css">
	<script src="../js/common.js"></script>
</head>

<body class="layui-layout-body">
	<div class="layui-layout layui-layout-admin">
		<div class="layui-header">
			<div class="layui-logo">后台管理系统</div>
			<!-- 头部区域（可配合layui已有的水平导航） -->
			<ul class="layui-nav layui-layout-left">
				<li class="layui-nav-item"><a href="center.html">首页</a></li>
				<li class="layui-nav-item"><a href="javascript:;"></a></li>
				<li class="layui-nav-item"><a href="javascript:;">商品管理</a></li>
				<li class="layui-nav-item"><a href="javascript:;"></a></li>
				<li class="layui-nav-item"><a href="javascript:;">商品添加</a></li>
			</ul>

			<ul class="layui-nav layui-layout-right">
				<li class="layui-nav-item">
					<a href="javascript:;">
						<img src="../assets/img/mao.png" class="layui-nav-img">
						<span id="adminName">God</span>
					</a>
				</li>
				<li class="layui-nav-item"><a href="javascript:;" id="logout">退出登录</a></li>
			</ul>
		</div>


		<div class="layui-side layui-bg-black">
			<div class="layui-side-scroll">
				<!-- 左侧导航区域（可配合layui已有的垂直导航） -->
				<ul class="layui-nav layui-nav-tree" lay-filter="test">
					<li class="layui-nav-item layui-nav-itemed">
						<a class="" href="center.html">首页</a>
					</li>

					<li class="layui-nav-item layui-nav-itemed">
						<a class="" href="javascript:;">商品管理</a>
						<dl class="layui-nav-child">
							<dd><a href="goodslist.html">商品列表</a></dd>
							<dd><a href="category.html">商品分类</a></dd>
							<dd><a href="javascript:;">商品添加</a></dd>
						</dl>
					</li>

					<li class="layui-nav-item">
						<a href="javascript:;">用户管理</a>
						<dl class="layui-nav-child">
							<dd><a href="user.html">用户列表</a></dd>
							<dd><a href="user_add.html">用户添加</a></dd>
						</dl>
					</li>
					<li class="layui-nav-item">
						<a href="javascript:;">订单管理</a>
						<dl class="layui-nav-child">
							<dd><a href="orders.html">订单列表</a></dd>
						</dl>
					</li>

				</ul>
			</div>
		</div>

		<div class="layui-body">

			<div class="table_center">
				<!--========================== 商品添加 添加内容区域 ==============================---->
				<div class="layui-form">
					<div class="layui-form-item">
						<label class="layui-form-label">商品名称</label>
						<div class="layui-input-block">
							<input type="text"  name="name" required lay-verify="required" placeholder="20字以内" autocomplete="off" maxlength="20"
							 class="layui-input" style="width: 311px;">
						</div>
					</div>
					<!--======商品价格========---->
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">商品价格</label>
							<div class="layui-input-inline">
								<input type="text" name="price" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>
					<!--======商品分类========---->
					<div class="layui-form-item">
						<label class="layui-form-label">商品分类</label>
						<div class="layui-input-block" style="width: 190px;">
							<select name="category" lay-verify="required">
								<option value="时尚">时尚</option>
								<option value="穿搭">穿搭</option>
								<option value="家具">家具</option>
								<option value="饮食">饮食</option>
								<option value="家电">家电</option>
							</select>
						</div>
					</div>
					<!--======商品图片========---->
					<div class="layui-form-item">
						<label class="layui-form-label">商品图片</label>
						<div class="layui-input-block" style="max-width:700px;">
							 <div class="layui-upload">
								<button type="button" class="layui-btn" id="tryUpload">多图片上传</button> 
								<blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
									预览图：
									<div class="layui-upload-list" id="demo2"></div>
								</blockquote>
								<a type="button" class="layui-btn" id="uploadBtn" href="javascript:;">开始上传</a>
							</div>
						</div>
					</div>
					<!--======库存========---->
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">库存</label>
							<div class="layui-input-inline">
								<input type="tel" name="stock" lay-verify="past" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>
					<!--======复选框========---->
					<div class="layui-form-item">
						<label class="layui-form-label">销量</label>
						<div class="layui-input-inline">
							<input type="tel" name="sales" lay-verify="past" autocomplete="off" class="layui-input">
						</div>
					</div>
					<!--======上架========---->
					<div class="layui-form-item">
						<label class="layui-form-label">上架</label>
						<div class="layui-input-block">
							<input type="checkbox" checked="" name="state" lay-skin="switch" lay-filter="switchTest" value="1" lay-text="ON|OFF">
						</div>
					</div>
					<!--======商品描述========---->
					<div class="layui-form-item layui-form-text">
						<label class="layui-form-label">描述</label>
						<div class="layui-input-block">
							<textarea name="description" placeholder="商品描述内容" class="layui-textarea"style="width: 400px; height: 100px;"></textarea>
						</div>
					</div>
					<div class="layui-form-item">
						<div class="layui-input-block">
							<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
							<button type="reset" class="layui-btn layui-btn-primary">重置</button>
						</div>
					</div>
				</div>

			</div>
		</div>


	</div>
	<script src="../assets/layui/layui.js"></script>
	<script>
		//JavaScript代码区域
		layui.use('element', function () {
			var element = layui.element;
			let quit =  document.querySelector('#logout');
            logging();
            quit.onclick = logout;
		});
	</script>
	<script>
		let picArr = [];
		layui.use(['form', 'laydate'], function () {
            var form = layui.form
				, layer = layui.layer;
			let state = 1;
			
			//监听提交
			form.on('submit(formDemo)', function (data) {
				layer.msg(JSON.stringify(data.field));
				data.field.state = state;
				for(let i=0;i<picArr.length;i++){
					let imgName = 'img' + (i * 1 + 1);
					data.field[imgName] = picArr[i];
				}
                let _data = objToStr(data.field);
                console.log(_data);
                ajax('PUT','/goodslist',_data);
                location.href = './goodslist.html';
			});

			form.on('switch(switchTest)', function(data){
				if(data.elem.checked) {
					state = "1";
				} else {
					state = "0";
				}
			});
		});
		layui.use('upload', function(){
			var $ = layui.jquery
			,upload = layui.upload;
			//多图片上传
			upload.render({
				elem: '#tryUpload'
				,url: '/goodslist/upload/'
				,multiple: true
				,auto:false
				,bindAction:'#uploadBtn'
				,choose: function(obj){
					//预读本地文件示例，不支持ie8
					obj.preview(function(index, file, result){
					$('#demo2').append('<img src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img" style="width:200px;margin:5px;">')
					});
				}
				,done: function(res){
					//上传完毕
					picArr.push(res.data[0].filename);
					console.log(picArr);
				}
			});
		})
	</script>
</body>

</html>